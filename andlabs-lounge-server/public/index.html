<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de">
	<head>
		<!-- Meta Information -->
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />

		<!-- Title -->
		<title>Lounge Server</title>

		<!-- Cascading Stylesheet -->
		<style type="text/css" media="screen, projection">
			@import "css/global.css";			
		</style>
		
		<!-- Setup jQuery -->
		<script src ="./js/jquery-1.9.1.min.js"></script>
		
		<!-- Setup the socket.io functionality -->
		<script src="/socket.io/socket.io.js"></script>
		
		<script type="text/javascript" language="javascript" >
			/**
			 *	Validates a parameter.
			 */
		    var validateParameter = function(value)
		    {
		   		return ("undefined" === typeof value) ? "" : value;
		    };

			/**
			 *	Establishing a socket io connection.
			 */
			var socket = io.connect();

			/**
			 *	Global Variable to store the playerID.
			 */
			var globalPlayerID = '';

			/**
			 *	This method is called after the socket.io connection was successful established.
			 */
			socket.on('connect', function()
			{
				globalPlayerID = '';
				
				// Add the username input.
				var usernameInput = $('<input/>',
				{
					id: 'username',
					value: 'Your username',
					type: 'text',
					click: function()
					{
						if ($(this).val() === 'Your username')
						{
							$(this).val('');	
						}
					},
					focusout: function()
					{
						if ($(this).val() === '')
						{
							$(this).val('Your username');
						}			
					},
					keyup: function(e)	
					{
						if (e.keyCode === 13)
						{
							var username = $("input#username").val();
							if ('' !== username &&
								'Your username' !== username)
							{
								socket.emit('login', { playerID: username });
							}
						}
						return false;	

					}
				});
				$("div#authentification").append(usernameInput);
				
				// Add the input button.								
				var inputButton = $('<input/>',
			    {
					id: 'login',
			        value: 'Login',
					type: 'submit',
			        click: function() 
					{
						var username = $("input#username").val();
						if (username !== 'Your username' &&
							username !== '')
						{
							globalPlayerID = username;
							socket.emit('login', { playerID: username });
						}	
						else
						{
							globalPlayerID = '';
							alert('Please enter an username!')
						}
						return false;												
					}
			    });
				
				// Add the username input and the login button.
				$("div#authentification").append(inputButton);				
			});
			
			/**
			 *	This method is used for the chat functionality.
			 */
			socket.on('login', function(payload)
			{
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.result))
				{
					if (payload.result)
					{
						if ('' !== validateParameter(payload.playerList))
						{
							// CheckIn the user.
							socket.emit('checkIn', { gameID: "andlabs.lounge.lobby", matchID: "andlabs.lounge.lobby" });							
							
							// Initialize Player List.
							$.each(payload.playerList, function(key, value) 
							{
								if ('' !== validateParameter(value.playerID) &&
									'' !== validateParameter(value.gameID));
								{
									if ('' !== validateParameter(value.matchID))
									{
  										$('div#connectedPlayer').append('<div class="player" playerID="' + value.playerID + '">' + value.playerID + '<div class="location">(' + value.gameID + ' | ' +  value.matchID+ ')</div></div>');
									}
									else
									{
									 	$('div#connectedPlayer').append('<div class="player" playerID="' + value.playerID + '">' + value.playerID + '<div class="location">(' + value.gameID + ')</div></div>');	
									}
								}
							});						

							// Remove the username and login button.
							$('div#authentification').empty();			  
							
							// Add the Logout Button.								
							var logoutButton = $('<input/>',
						    {
								id: 'logout',
						        value: 'Logout',
								type: 'submit',
						        click: function () 
								{
									globalPlayerID = '';
									socket.emit('logout');
									return false;														
								}
						    });
					
							$("div#authentification").append(logoutButton);
							
							createMatchFunctionality();
											
							// Add the chat functionality.							
							var chatMessageInput =  $('<textarea/>',
						    {
								id: 'chatMessageInput',
						        value: 'chattext here',
								click: function()
								{
									if ($(this).val() === 'Type your chat message here.')
									{
										$(this).val('');	
									}
									return false;
								},	
								keyup: function(e)	
								{
									if (e.keyCode === 13)
									{
										var message = $(this).val();
										if ('' !== message)
										{
											socket.emit('chat', { message: message });
										}
									}
									return false;	
								}
						    });	
							chatMessageInput.append("Type your chat message here.")						
							$('div#createChatMessage').append(chatMessageInput);		
							
							var chatMessageSubmit =  $('<input/>',
						    {
								id: 'chatMessageSubmit',
						        value: 'Send',
								type: 'submit',
						        click: function () 
								{
									var message = $("textarea#chatMessageInput").val();
									socket.emit('chat', { message: message });
									return false;													
								}														
						    });						
							$('div#createChatMessage').append(chatMessageSubmit);														
						}
						
						var resetInput = $('<input/>',
						{
							id: 'resetPasswordInput',
							type: 'password',
							value: 'Password',
							click: function()
							{
								if ($(this).val() === 'Password')
								{
									$(this).val('');
								}
							}
						})
						$('#resetArea').append(resetInput);
						
						var inputButton = $('<input/>',
						{
							id: 'resetDatabase',
							type: 'submit',
							value: 'Reset',
							click: function() 
							{
								var password = $('#resetPasswordInput').val();
								socket.emit('debugDropCollections', { password: password });
							}
						});
						$('#resetArea').append(inputButton);
					}
					else
					{
						globalPlayerID = '';
						var description = payload.description;
						if ('' !== validateParameter(description))
						{
							alert(description);
						}					
					}
				}
			});		
			
			socket.on('debugDropCollections', function(payload)
			{
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.result))
				{
					if (payload.result)
					{
						window.location.reload();
					}
					else
					{
						alert("Cannot drop the database!");
					}
				}
			});
			
			/**
   			 *	This method is called after the user was disconnected.
			 */
			socket.on('disconnect', function () 
			{	
				globalPlayerID = '';
				
				// Reconnect to the server.
				socket.socket.connect();
				
				// Remove the logout button.
				$('div#authentification').empty();
				
				// Remove all open games.
				$('ul#openMatchesList').empty();
				
				// Remove all chat messages.
				$('div#chatMessages').empty();
				
				// Remove all running games.
				$('ul#runningMatchesList').empty();
				
				// Remove all online user.
				$('div#connectedPlayer').empty();
				
				// Remove the create match functionality.
				$('div#createMatch').empty();
				
				// Remove the chat functionality.
				$('div#createChatMessage').empty();
				
				// Remove the inspection window of an running match.				
				$('div.inspectGame').remove();
				
				// Remove the reset button.
				$('#resetArea').empty();
			});
			
			/**
			 *	This method gets called if a user authenticated successful.	
			 */
			socket.on('addPlayer', function(payload) 
			{
				if ('' !== validateParameter(payload) && 
					'' !== validateParameter(payload.playerID))
				{
  					$('div#connectedPlayer').append('<div class="player" playerID="' + payload.playerID + '">' + payload.playerID + '<div class="location"></div></div>');
				}
			});
			
			/**
			 *	This method gets called if a user did a logout.	
			 */
			socket.on('delPlayer', function(payload)
			{
				if ('' !== validateParameter(payload) && 
					'' !== validateParameter(payload.playerID))
				{
					$(".player[playerID = '" + payload.playerID + "']").remove();
				}
			});

			/**
			 *	This method is used for the chat callback.
			 */
			socket.on('chat', function(payload) 
			{
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.result))
				{
					if (payload.result)
					{
						$('#chatMessageInput').val('');
					}
					else
					{
						if ('' !== validateParameter(payload.description))
						{
							alert(payload.description);
						}
					}
				}				
			});
			
			/**
			 *	This method is used to add a chat message.
			 */
			socket.on('addChatMessage', function(payload) 
			{
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.playerID) &&
					'' !== validateParameter(payload.message))
				{
					$('#chatMessages').append('<li class="chatMessage" style="border-bottom:none;"><div class="chatMessageUser">' + payload.playerID + ":</div><div class='chatMessageValue'>" + payload.message + '<br/></div></li>');
				}				
			});
						
			/**
			 *	This method is used for the join callback.
			 */
			socket.on('join', function(payload)
			{
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.result) &&
					'' !== validateParameter(payload.description))
				{
					if (payload.result)
					{
						if ('create' === payload.description)
						{
							createMatchFunctionality();
						}
						else if ('join' == payload.description)
						{
							
						}
						else
						{
							alert('Wrong description for the success routine.');
						}
					}
					else
					{
						if ('' !== validateParameter(payload.description))
						{
							alert(payload.description);
						}
					}
				}				
			});
			
			/**
			 *	This method is called after a user creates a Match.
			 */
			socket.on('joinMatch', function(payload)
			{			
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.gameID) &&
					'' !== validateParameter(payload.matchID) &&
					'' !== validateParameter(payload.gameName) &&
				 	'' !== validateParameter(payload.totalSpots) &&
				 	'' !== validateParameter(payload.status) &&
					'' !== validateParameter(payload.gameType) &&
					'' !== validateParameter(payload.playerIDs))
				{					
					// Decide which status should be displayed
					if ('created' === payload.status ||
						'join' === payload.status)
					{
						
						// Create the match.
						var joinMatchSubmit = $('<input/>',
					    {
							class: 'joinMatchSubmit',
					        text: 'Join',
							matchID: payload.matchID,
							type: 'submit',
					        click: function () 
							{ 					
								socket.emit('join', { gameID: payload.gameID, matchID: payload.matchID });
							}
					    });

						var openSpots = payload.totalSpots - payload.playerIDs.length;
						
						// Check if the match is already in the list of open matches.
						if ($(".openMatch[matchID = '" + payload.matchID + "']").length > 0)
						{
							// Update the open spots. 
							$(".openMatch[matchID = '" + payload.matchID + "'] .openSpots").text(openSpots);
						}
						else
						{
							// Create the game.
							$("ul#openMatchesList").append("<li class='openMatch' matchID='" + payload.matchID + "'><span style='font-weight:bold'>Game ID:</span><br><span style='margin: 0px 14px;'>" + payload.gameID+ "</span><br><span style='font-weight:bold'>Game Name:</span><br><span style='margin: 0px 14px;'>" + payload.gameName + "</span><br><span style='font-weight:bold'>Match ID:</span><br><span style='margin: 0px 14px;'>" + payload.matchID + "</span><br><span style='font-weight:bold'>Game Type:</span><br><span style='margin: 0px 14px;'>" + payload.gameType + "</span><br><span style='font-weight:bold'>Open Spots:</span><div class='openSpots'><span style='margin: 0px 14px;'>" + openSpots + "</span></div><br></li>");
						}	
					
						// Check if user is in the list of playerIDs.
						var foundPlayer = false;
						$.each(payload.playerIDs, function(key, value) {
							if (value.playerID === globalPlayerID)
							{
								foundPlayer = true;
							}
						});

						// Add or remove the joinMatchSubmit
						if (!foundPlayer)
						{
							$(".openMatch[matchID = '" + payload.matchID + "']").append(joinMatchSubmit);							
						}
						else
						{
							$(".openMatch[matchID = '" + payload.matchID + "'] .joinMatchSubmit").remove()
						}					
					}
					else if ('running' === payload.status)
					{
						// Remove the entry in the open games box.
						$(".openMatch[matchID = '" + payload.matchID + "']").remove();
						
						// Create the match.
						var inspectGameSubmit = $('<input/>',
					    {
							class: 'inspectGameSubmit',
					        value: 'Play',
							matchID: payload.matchID,
							type: 'submit',
					        click: function () 
							{ 				
								// Remove the old inspectGame div.
								$('.inspectGame').remove();
								
								// Display the new inspectGame div
								$('#wrapper').append('<div id="box" class="inspectGame" matchID="' + payload.matchID + '"><div id="box_cont" style="background-color: rgb(23, 200, 200);"></div></div>');
								
								// Create a button to close the current inspected match window.
								var closeInspectMatchWindowSubmit = $('<input/>', 
								{
									class: 'closeInspectMatchWindowSubmit',
									value: 'x',
									type: 'submit',
									click: function ()
									{
										// Remove the old inspectGame div.
										$('.inspectGame').remove();
										
										// CheckIn the user.
										socket.emit('checkIn', { gameID: "andlabs.lounge.lobby", matchID: "andlabs.lounge.lobby" });
									}
								});
								
								// Add the button to the inspectMatchBox.
								$('.inspectGame[matchID = "' + payload.matchID + '"] #box_cont').append(closeInspectMatchWindowSubmit);
								
								// Create a button to close the current inspected match.
								var closeInspectMatchSubmit = $('<input/>', 
								{
									class: 'closeInspectMatchSubmit',
									value: 'Close the Match',
									type: 'submit',
									click: function ()
									{
										// CheckIn the user.
										socket.emit('update', { gameID: payload.gameID, matchID: payload.matchID, status: "close" });
									}
								});
								
								// Add the button to the inspectMatchBox.
								$('.inspectGame[matchID = "' + payload.matchID + '"] #box_cont').append(closeInspectMatchSubmit);
															
								// Update the user status.
								socket.emit('checkIn', {gameID: payload.gameID, matchID: payload.matchID});
								
								// Decide which game type we are playing.
								if ('move' === payload.gameType)
								{
									// Receive last move.
									socket.emit('lastMove', { gameID: payload.gameID, matchID: payload.matchID });
								}
								else if ('stream' === payload.gameType)
								{
									// Create the canvas
									var canvas = $('<canvas/>',
									{
										id: 'ballCanvas',
										'style': 'width: 250px; height: 300px; background-color: white;',
									});
									
									// Prepare the ui for the ball game.
									$('.inspectGame[matchID = "' + payload.matchID + '"] #box_cont').append(canvas);
							
									var color = createRandomColor();
									canvas.mousemove(function(event)
									{
										
										var rect = canvas[0].getBoundingClientRect();
										var x = event.clientX - rect.left;
										var y = event.clientY - rect.top;

										socket.emit('stream', {gameID: payload.gameID, matchID: payload.matchID, move: {x: x, y: y, color: color}});
										paintBall(payload.gameID, payload.matchID, x, y, color);
									});	
								}
							}
					    });						
						
						// Remove the old state in open games.
						if ($(".runningMatch[matchID = '" + payload.matchID + "']").length === 0)
						{
							$("ul#runningMatchesList").append("<li class='runningMatch' matchID='" + payload.matchID+ "'><span style='font-weight:bold'>Game ID:</span><br><span style='margin: 0px 14px;'>" + payload.gameID+ "</span><br><span style='font-weight:bold'>Game Name:</span><br><span style='margin: 0px 14px;'>" + payload.gameName + "</span><br><span style='font-weight:bold'>Match ID:</span><br><span style='margin: 0px 14px;'>" + payload.matchID + "</span><br><span style='font-weight:bold'>Game Type:</span><br><span style='margin: 0px 14px;'>" + payload.gameType + "</span><br><span style='font-weight:bold'>Participants:</span><br><div class='" + payload.matchID+"' style='margin: 0px 14px;'></div></li>");
							$.each(payload.playerIDs, function(key, value) {
								if (0 === key)
								{
									$('.' + payload.matchID).append(value.playerID);
								}
								else
								{
									$('.' + payload.matchID).append(" | " + value.playerID);									
								}
							});						
							$(".runningMatch[matchID = '" + payload.matchID + "']").append(inspectGameSubmit);			
						}
					}
					else if ('close' === payload.status)
					{	
						// Remove the entry in the open games box.
						$(".openMatch[matchID = '" + payload.matchID + "']").remove();
						
						// Remove the entry in the running games box.
						$(".runningMatch[matchID = '" + payload.matchID + "']").remove();
						
						// Remove the game div if it is currently visible
						if ($(".inspectGame[matchID  = '" + payload.matchID + "']").length > 0 )
						{
							$(".inspectGame[matchID  = '" + payload.matchID + "']").remove();
							
							// CheckIn to Lobby.
							socket.emit('checkIn', { gameID: "andlabs.lounge.lobby", matchID: "andlabs.lounge.lobby" });							
						}
					}					
				}
			});	
		
			/**
			 *	This method is the user callback after the attempt of a match move.
			 */
			socket.on('move', function(payload)
			{
				// Handle the move callback after successful match move.
			});
			
			/**
			 *	This method is called after a user did a match move.
			 */
			socket.on('moveMatch', function(payload)
			{
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.gameID) &&
					'' !== validateParameter(payload.matchID) &&
					'' !== validateParameter(payload.move))
				{
					handleMove(payload.gameID, payload.matchID, payload.move);
				}
			});
			
			/**
			 *	This is the callback after an user updates a match status.
			 */
			socket.on('update', function(payload)
			{
				// Handle a update match callback.
			});			
			
			/**
			 *	This is the callback if the user is performing a checkIn.
			 */
			socket.on('checkIn', function(payload)
			{
				// Handle checkIn callback.
			});
			
			/**
			 *	This method is called after an user did a checkIn.
			 */
			socket.on('checkInUser', function(payload)
			{
				if ( '' !== validateParameter(payload) &&
					 '' !== validateParameter(payload.gameID) &&
					 '' !== validateParameter(payload.playerID))
				{
					if ('' !== validateParameter(payload.matchID))
					{
						$('.player[playerID = "' + payload.playerID + '"] div.location').text('(' + payload.gameID + ' | ' + payload.matchID + ')');
					}
					else
					{
						if ('andlabs.lounge.lobby' === payload.gameID)
						{
							$('.player[playerID = "' + payload.playerID + '"] div.location').text('(' + payload.gameID + ')');
						}
					}
				}
			});
			
			/**
			 *	User receives the last move for a specific matchID.
			 */
			socket.on('lastMove', function(payload)
			{
				if ('' !== validateParameter(payload) &&
					'' !== validateParameter(payload.result))
				{
					if (payload.result)
					{
						if ('' !== validateParameter(payload.gameID) &&
							'' !== validateParameter(payload.matchID))
						{
							createInspectionInputFields(payload.gameID, payload.matchID);
							createInspectionSubmit(payload.gameID, payload.matchID);
							createLastMoveArea(payload.gameID, payload.matchID);
							
							if ('' !== validateParameter(payload.move))
							{
								handleMove(payload.gameID, payload.matchID, payload.move);
							}
						}
					}
					else
					{
						if ('' !== validateParameter(payload.description))
						{
							alert(payload.description);
						}
					}
				}
			});
			
			/**
			 *	Receive a stream package.
			 */
			socket.on('stream', function(payload)
			{
				if ( '' !== validateParameter(payload) &&
					 '' !== validateParameter(payload.gameID) &&
					 '' !== validateParameter(payload.matchID) &&
				 	 '' !== validateParameter(payload.move))
				{
					// Ball Game
					var move = payload.move;
					if ('' !== move.x &&
						'' !== move.y &&
						'' !== move.color)
					{
						paintBall(payload.gameID, payload.matchID, move.x, move.y, move.color);
					}
				}
			});
			
			/**
			 *	Handle a move
			 */
			var handleMove = function(gameID, matchID, move)
			{
				if (!move)
				{
					return;
				}

				// Remove the old move.
				$('.inspectGame[matchID = "' + matchID + '"] #box_cont .currentMove').empty();
				
				var JSONObj = $.parseJSON(move)
				$.each(JSONObj, function(key, value)
				{
					$('.inspectGame[matchID = "' + matchID + '"] #box_cont .currentMove').append("" + key + " &rarr; " + value + "<br>")
				});								
			}			
			
			/**
			 *	Create empty key/value input fields.
			 */
			var createInspectionInputFields = function(gameID, matchID)
			{
				for (var i = 0; i < 8; i++)
				{
					var div = $('<div/>',
					{
						 class:'inspectionInput'
					});
					
					var key = $('<input/>', 
					{
						class: 'inspectionInputKey' + i,
						value: 'key',
						type: 'text',
						style: 'width: 80px; margin-right: 10px;'
					});
					var value = $('<input/>', 
					{
						class: 'inspectionInputValue' + i,
						value: 'value',
						type: 'text',
						style: 'width: 80px'
					});	
					$('.inspectGame[matchID = "' + matchID + '"] #box_cont').append(div)
					div.append(key);					
					div.append(value);					
				}			
			}
			
			/**
			 *	Create the inspection submit field.
			 */
			var createInspectionSubmit = function(gameID, matchID)
			{					
				// Create a button to close the current inspected match.
				var createInspectionSubmit = $('<input/>', 
				{
					class: 'createInspectionSubmit',
					value: 'Send',
					type: 'submit',
					click: function ()
					{
						var jsonObj = {};
						var createPkg = false;
						
						// CheckIn the user.
						$('.inspectGame[matchID = "' + matchID + '"] #box_cont .inspectionInput').each(function(key, val)
						{
							var k = $('.inspectGame[matchID = "' + matchID + '"] #box_cont .inspectionInput .inspectionInputKey' + key );
							var v = $('.inspectGame[matchID = "' + matchID + '"] #box_cont .inspectionInput .inspectionInputValue' + key );

							if ('key' !== k.val() &&
								'value' !== v.val() &&
								'' !== k.val())
							{
								jsonObj[k.val()] = v.val();
								createPkg = true;
							}
						});
						var myString = JSON.stringify(jsonObj);
						
						if (createPkg)
						{
							socket.emit('move', {gameID: gameID, matchID: matchID, move: myString})
						}
					}
				});
				$('.inspectGame[matchID = "' + matchID + '"] #box_cont').append(createInspectionSubmit);	
			}
			
			/**
			 *	Create the last move area.
			 */
			var createLastMoveArea = function(gameID, matchID)
			{
				// Add the new move.
				var div = $('<div/>',
				{
					class: 'currentMove'
				});
				$('.inspectGame[matchID = "' + matchID + '"] #box_cont').append(div);
			}
			
			/**
			 * Create a random color.
			 */
			var createRandomColor = function () 
			{
			    var letters = '0123456789ABCDEF'.split('');
			    var color = '#';
			    for (var i = 0; i < 6; i++ ) 
				{
			        color += letters[Math.round(Math.random() * 15)];
			    }
			    return color;
			}
			
			/**
			 *	Paint the ball.
			 */
			var paintBall = function(gameID, matchID, x, y, color)
			{
				var canvas = $('.inspectGame[matchID = "' + matchID + '"] #box_cont #ballCanvas');
				var context = canvas[0].getContext('2d');
				context.beginPath();
				context.arc(x, y, 5, 0, 2 * Math.PI, false);
				context.fillStyle = color;
				context.fill();
			}
			
			var createMatchFunctionality = function()
			{
				$('div#createMatch').empty();
				
				// Add the create match functionality.
				var matchGameInput =  $('<input/>',
			    {
					id: 'matchGameID',
			        value: 'The game id',
					type: 'text',
					click: function()
					{
						if ($(this).val() === 'The game id')
						{
							$(this).val('');	
						}
					},
					focusout: function()
					{
						if ($(this).val() === '')
						{
							$(this).val('The game id');
						}			
					}							
			    });
				
				$('div#createMatch').append(matchGameInput);
				
				var matchGameNameInput =  $('<input/>',
			    {
					id: 'matchGameName',
			        value: 'The game name',
					type: 'text',
					click: function()
					{
						if ($(this).val() === 'The game name')
						{
							$(this).val('');	
						}
					},
					focusout: function()
					{
						if ($(this).val() === '')
						{
							$(this).val('The game name');
						}			
					}																
			    });
				
				$('div#createMatch').append(matchGameNameInput);
				
				var maximumPlayerLabel = $('<label for="matchMaximumPlayer">Maximum Player:</label>');							
				var matchMaximumPlayerInput =  $('<input/>',
			    {
					id: 'matchMaximumPlayer',
			        value: 2,
					type: 'text',
					click: function()
					{
						if ($(this).val() === '2')
						{
							$(this).val('');	
						}
					},
					focusout: function()
					{
						if ($(this).val() === '')
						{
							$(this).val(2);
						}			
					}									
			    });
				$('div#createMatch').append(maximumPlayerLabel);
				$('div#createMatch').append(matchMaximumPlayerInput);		

				var streamLabel = $('<label for="matchStreamGame">Stream Match:</label>');
				var matchStreamGameCheckbox = $('<input/>',
				{
					id: 'matchStreamGame',
					value: 'Stream Game',
					name: 'Stream Game',
					type: 'checkbox'
				});
				$('div#createMatch').append(streamLabel);
				$('div#createMatch').append(matchStreamGameCheckbox);
				
				var matchCreateSubmit =  $('<input/>',
			    {
					id: 'matchCreateSubmit',
			        value: 'Create Match',
					type: 'submit',
			        click: function () 
					{
						var gameID = $("input#matchGameID").val();
						var gameName = $("input#matchGameName").val();
						var maximumPlayers = $("input#matchMaximumPlayer").val();
						var gameType = '';
						
						if (!('' !== gameID &&
							'The game id' !== gameID &&
							'' !== gameName &&
							'The game name' !== gameName &&
							'' !== maximumPlayers))
						{
							alert("Please fill out all required fields!");
							return false;
						}
						
						if ($("input#matchStreamGame").is(":checked"))
						{
							gameType = 'stream';
						}
						else
						{
							gameType = 'move';
						}
						socket.emit('join', { gameID: gameID, gameName: gameName, maximumPlayers: maximumPlayers, gameType: gameType });
						return false;														
					}														
			    });
				
				$('div#createMatch').append(matchCreateSubmit);	
			}
		</script>		
	</head>
<body>

	<div id="wrapper">
		<div id="header"><h1><strong>Lounge Server</strong></h1>
			<div id="authentification">
			</div>
		</div>


		<!-- Open Matches -->
		<div id="box">
			<div id="box_cont" style="background-color: rgb(144, 71, 44);">
				<div id="box_title">Open Matches</div> 
				<ul id="openMatchesList">
				</ul>
			</div>
			<div id="createMatch">
			</div>
		</div>
		
		<!-- Chat -->
		<div id="box">
			<div id="box_cont" style="background-color: rgb(21, 68, 82);">
				<div id="box_title">Chat</div>				
				<ul id="chatMessages">
				</ul>
			</div>
			<div id="createChatMessage">
			</div>
		</div>

		<!-- Running Matches  -->
		<div id="box">
			<div id="box_cont" style="background-color: rgb(21, 95, 64);">
				<div id="box_title">Running Matches</div>
				<ul id="runningMatchesList">
				</ul>	
			</div>
			<div id="box_bottom"></div>
		</div>
		
		<!-- Online Player -->
		<div id="box">		
			<div id="box_cont" style="background-color: rgb(146, 139, 21);">
				<div id="box_title">Online Players</div>
				<div id="connectedPlayer">
				</div>
			</div>	
			<div id="status_bottom">
				<div id="resetArea">
				</div>
			</div>			
		</div>		
	</div>	
</body>
</html>